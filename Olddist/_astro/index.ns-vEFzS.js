import{j as c}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.BVOCwoKb.js";import{i as N,u as E,f as _,c as z,a as m,b as A,d as W,s as S,m as j}from"./proxy.CZpQSHvn.js";import{u as b}from"./use-motion-value.cXacd6D_.js";function H(...t){const e=!Array.isArray(t[0]),r=e?0:-1,o=t[0+r],n=t[1+r],a=t[2+r],u=t[3+r],s=N(n,a,u);return e?s(o):s}function D(t,e){const r=b(e()),o=()=>r.set(e());return o(),E(()=>{const n=()=>_.preRender(o,!1,!0),a=t.map(u=>u.on("change",n));return()=>{a.forEach(u=>u()),z(o)}}),r}function X(t){m.current=[],t();const e=D(m.current,t);return m.current=void 0,e}function Y(t,e,r,o){if(typeof t=="function")return X(t);const n=typeof e=="function"?e:H(e,r,o);return Array.isArray(t)?v(t,n):v([t],([a])=>n(a))}function v(t,e){const r=A(()=>[]);return D(t,()=>{r.length=0;const o=t.length;for(let n=0;n<o;n++)r[n]=t[n].get();return e(r)})}function B(t){t.values.forEach(e=>e.stop())}function x(t,e){[...e].reverse().forEach(o=>{const n=t.getVariant(o);n&&S(t,n),t.variantChildren&&t.variantChildren.forEach(a=>{x(a,e)})})}function O(t,e){if(Array.isArray(e))return x(t,e);if(typeof e=="string")return x(t,[e]);S(t,e)}function P(){const t=new Set,e={subscribe(r){return t.add(r),()=>void t.delete(r)},start(r,o){const n=[];return t.forEach(a=>{n.push(W(a,r,{transitionOverride:o}))}),Promise.all(n)},set(r){return t.forEach(o=>{O(o,r)})},stop(){t.forEach(r=>{B(r)})},mount(){return()=>{e.stop()}}};return e}function $(){const t=A(P);return E(t.mount,[]),t}const F=$,M=300,w=300,T=8;function G(t){return Array.from(t).reduce((e,r)=>e*31+r.charCodeAt(0),0)>>>0}function g(t){const e=Math.sin(t)*1e4;return e-Math.floor(e)}function U(){const[t,e]=i.useState(()=>typeof window>"u"?!0:window.innerWidth>=768);return i.useEffect(()=>{const r=()=>e(window.innerWidth>=768);return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),t}function q({item:t,index:e,draggingId:r,containerRef:o,zOrder:n,setZOrder:a}){const s=b(0),f=b(0);Y(f,[-80,80],[-6,6]);const d=F(),l=i.useMemo(()=>G(t.id),[t.id]),R=i.useMemo(()=>g(l)*200-100,[l]),C=i.useMemo(()=>g(l+1)*-200-50,[l]),y=U(),I=i.useMemo(()=>y?g(l+2)*10-5:0,[l,y]);i.useEffect(()=>{const p=setTimeout(()=>{d.start({x:0,y:0,opacity:1,transition:{delay:e*.1,duration:.6,type:"spring",stiffness:120}})},1700);return()=>clearTimeout(p)},[d,e]);const L=()=>{r.current=t.id,a(p=>[...p.filter(h=>h!==t.id),t.id]),typeof window<"u"&&"vibrate"in window.navigator&&window.navigator.vibrate(10)},V=()=>{r.current=null,d.start({x:0,y:0,transition:{type:"spring",stiffness:300}})},k=()=>{a(p=>[...p.filter(h=>h!==t.id),t.id]),d.start({scale:1.04}).then(()=>d.start({scale:1,transition:{duration:.2}}))};return c.jsxs(j.div,{initial:{x:R,y:C,rotate:I,opacity:0},animate:d,drag:!0,dragConstraints:o,dragElastic:.15,dragMomentum:!1,onDragStart:L,onDragEnd:V,onTap:k,role:"button","aria-grabbed":r.current===t.id,className:`
        absolute
        md:relative
        md:left-auto
        md:top-auto
      `,style:{x:s,y:f,width:M,height:w,top:0,left:`${e*T}px`,marginLeft:e===0?0:-120,zIndex:n.indexOf(t.id)+1,borderRadius:16,backgroundColor:"white",boxShadow:r.current===t.id?"0 25px 50px rgba(0,0,0,0.35)":"0 10px 20px rgba(0,0,0,0.15)",overflow:"hidden",touchAction:"none",userSelect:"none",display:"flex",flexDirection:"column",transition:"box-shadow 0.2s ease"},children:[c.jsx("img",{src:t.src,alt:t.alt||"",draggable:!1,className:"w-full h-full object-cover",onError:p=>{const h=p.target;h.onerror=null,h.src="data:image/svg+xml;base64,..."}}),(t.label||t.alt)&&c.jsx("div",{className:"absolute bottom-2 left-2 px-2 py-1 text-background bg-foreground/50 rounded",children:t.label||t.alt})]})}function tt({items:t,paddingTop:e="normal",paddingBottom:r="normal"}){const o=i.useRef(null),n=i.useRef(null),[a,u]=i.useState(t.map(s=>s.id));return c.jsxs("div",{ref:o,className:"relative w-full overflow-x-clip touch-none h-[400px] md:h-[300px]",style:{height:w,userSelect:"none"},children:[c.jsx("div",{className:"relative md:hidden h-full",children:t.map((s,f)=>c.jsxs(j.div,{style:{position:"absolute",width:M,height:w,top:0,left:"50%",transform:`translateX(-50%) translateX(${f*T}px)`,zIndex:f,borderRadius:16,backgroundColor:"white",boxShadow:"0 10px 20px rgba(0,0,0,0.15)",overflow:"hidden",userSelect:"none"},children:[c.jsx("img",{src:s.src,alt:s.alt||"",draggable:!1,className:"w-full h-full object-cover",onError:d=>{const l=d.target;l.onerror=null,l.src="data:image/svg+xml;base64,..."}}),(s.label||s.alt)&&c.jsx("div",{className:"absolute bottom-2 left-2 px-2 py-1 text-background bg-foreground/50 rounded",children:s.label||s.alt})]},s.id))}),c.jsx("div",{className:"hidden md:flex justify-center items-center h-full relative",children:t.map((s,f)=>c.jsx(q,{item:s,index:f,draggingId:n,containerRef:o,zOrder:a,setZOrder:u},s.id))})]})}export{tt as default};
